{% extends 'base.html' %}
{% load static %}
{% block title %}{{ user.username }}{% endblock title %}
{% block link %}
    <link rel="stylesheet" type="text/css" href="{% static "css/profile.css" %}">
{% endblock link %}
{% block script %}
    <script type="text/javascript">

        function uploadImage(filesParent) {
            $(".picFrame .link, .picFrame .drop, .pic").addClass("hidden");
            uploadFile(filesParent.files[0], function (url) {
                var filename = url.substring(url.lastIndexOf("/") + 1);
                $(".profile-image-file-name").val(filename);
                $(".pic").attr("src", url);
                $(".picFrame").removeClass("hidden");
                $(".picFrame .link, .pic").removeClass("hidden");
                $(".picFrame").addClass("poof");
            }, "{{ user.username }}");
        }

        $(document).ready(function () {
            $(".edit .picFrame .ajaxUpload").click(function () {
                $(".profile-image-file-input").click()
            });
            $(".edit .picFrame .remove").click(function () {
                $(".pic").attr("src", "usr/placeholder-profile.jpg");
                $(".profile-image-file-name").val("");
                $(".picFrame .remove").addClass("hidden");
            });
            $(".edit .picFrame").on("dragover", function (jqe) {
                jqe.preventDefault();
            }).on("drop", function (jqe) {
                jqe.preventDefault();
                uploadImage(jqe.originalEvent.dataTransfer);
            });
            $(".profile-image-file-input").change(function () {
                uploadImage(this);
            });

            $('.error :input').popover({
                placement: 'left',
                container: 'body',
                trigger: 'focus',
                html: true,
                content: function () {
                    return $('.' + $(this).attr('name') + ' .message').html();
                }
            });
        });
    </script>
{% endblock script %}
{% block content %}
    <div class="container-fluid center-container nedit space-above">
        <div class="row space-below">
            <div class="col-xs-12">
                <div class="page-box">
                    <div class="row">
                        <div class="col-xs-12">
                            <h5 class="top-text">{{ user.username }}</h5>

                        </div>
                        <div class="col-md-6 col-xs-12 pull-right col-centered space-above">
                            <div class="picFrame poof">
                                <img class="pic super-center" src="/uploads/{{ user.hybrid.image }}">
                            </div>
                        </div>
                        <div class="col-md-6 col-xs-12 pull-left space-above">
                            <h1 class="big-title">{{ user.first_name }} {{ user.hybrid.middle_name }} {{ user.last_name }}</h1>
                            <br>
                            <div style="overflow-x: auto">
                                <table class="info-table">
                                    {% if user.email %}
                                        <tr>
                                            <td>Email</td>
                                            <td>{{ user.email }}</td>
                                        </tr>
                                    {% endif %}
                                    <tr>
                                        <td>Medlem</td>
                                        <td>{% if user.hybrid.member %}Ja{% else %}Nei{% endif %}</td>
                                    </tr>
                                    {% if user.groups.all %}
                                        <tr>
                                            <td>Medlem av</td>
                                            <td>
                                                {% for group in user.groups.all %}
                                                    {{ group }}<br>
                                                {% endfor %}
                                            </td>
                                        </tr>
                                    {% endif %}
                                    <tr>
                                        <td>Avgangs√•r</td>
                                        <td>{{ user.hybrid.graduation_year }}</td>
                                    </tr>
                                    {% if user.hybrid.specialization %}
                                        <tr>
                                            <td>Spesialisering</td>
                                            <td>{{ user.hybrid.specialization }}</td>
                                        </tr>
                                    {% endif %}
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock content %}